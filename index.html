<!DOCTYPE html>
<html>
<head>
  <title>Color Trading Login</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <!-- Firebase -->
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth.js"></script>

  <style>
    body{
      font-family: Arial;
      text-align:center;
      background:#f2f2f2;
    }

    .box{
      margin:50px auto;
      width:90%;
      max-width:350px;
      background:white;
      padding:20px;
      border-radius:10px;
      box-shadow:0 0 10px gray;
    }

    input{
      width:90%;
      padding:10px;
      margin:10px;
      font-size:16px;
    }

    button{
      width:90%;
      padding:12px;
      background:green;
      color:white;
      border:none;
      font-size:18px;
      border-radius:5px;
    }

    #game{
      display:none;
    }

    .btn{
      padding:12px;
      margin:5px;
      width:100px;
      border:none;
      color:white;
      font-size:18px;
      border-radius:5px;
    }

    .red{background:red;}
    .green{background:green;}
    .violet{background:purple;}
  </style>
</head>

<body>

<div class="box" id="loginBox">

  <h2>Mobile Login</h2>

  <div id="recaptcha-container"></div>

  <input type="text" id="phone" placeholder="+91XXXXXXXXXX">

  <button onclick="sendOTP()">Send OTP</button>

  <input type="text" id="otp" placeholder="Enter OTP">

  <button onclick="verifyOTP()">Verify</button>

  <p id="msg"></p>

</div>

<!-- GAME -->
<div class="box" id="game">

  <h2>Color Trading</h2>

  <h3>Balance: ‚Çπ<span id="bal">100</span></h3>

  <button class="btn red" onclick="play('Red')">Red</button>
  <button class="btn green" onclick="play('Green')">Green</button>
  <br><br>
  <button class="btn violet" onclick="play('Violet')">Violet</button>

  <p id="result"></p>

</div>


<script type="module">

import { initializeApp } from "https://www.gstatic.com/firebasejs/9.23.0/firebase-app.js";
import { getAuth, RecaptchaVerifier, signInWithPhoneNumber } 
from "https://www.gstatic.com/firebasejs/9.23.0/firebase-auth.js";


const firebaseConfig = {
  apiKey: "AIzaSyBrn9YpqQby99K00hyjunSwFjROpwoESQA",
  authDomain: "radhika-ebb38.firebaseapp.com",
  projectId: "radhika-ebb38",
  storageBucket: "radhika-ebb38.appspot.com",
  messagingSenderId: "965818662155",
  appId: "1:965818662155:web:470e8aee905a19c1ecf60e"
};

const app = initializeApp(firebaseConfig);
const auth = getAuth(app);


// Recaptcha
window.recaptchaVerifier = new RecaptchaVerifier(
  'recaptcha-container',
  { size: 'invisible' },
  auth
);


// Send OTP
window.sendOTP = function(){

  let phone = document.getElementById("phone").value;

  signInWithPhoneNumber(auth, phone, window.recaptchaVerifier)
  .then(function(confirmationResult){

    window.confirmationResult = confirmationResult;
    document.getElementById("msg").innerHTML="OTP Sent ‚úÖ";

  }).catch(function(error){

    document.getElementById("msg").innerHTML=error.message;

  });
}


// Verify OTP
window.verifyOTP = function(){

  let code = document.getElementById("otp").value;

  confirmationResult.confirm(code)
  .then(function(){

    document.getElementById("loginBox").style.display="none";
    document.getElementById("game").style.display="block";

  }).catch(function(){

    document.getElementById("msg").innerHTML="Wrong OTP ‚ùå";

  });

}


// Game
let balance = 100;

window.play = function(color){

  let arr = ["Red","Green","Violet"];
  let win = arr[Math.floor(Math.random()*3)];

  if(color == win){
    balance += 10;
    document.getElementById("result").innerHTML="You Win üéâ ("+win+")";
  }else{
    balance -= 10;
    document.getElementById("result").innerHTML="You Lost üò¢ ("+win+")";
  }

  document.getElementById("bal").innerHTML = balance;

}

</script>

</body>
</html>
